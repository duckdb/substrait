# name: test/sql/test_substrait_substring.test
# description: Test get_substrait with simple subqueries
# group: [sql]

require substrait

statement ok
PRAGMA enable_verification

statement ok
create table t (a varchar)

statement ok
insert into t values ('pedro'), ('mark'), ('diego')

query I
select substring(a FROM 1 FOR 2) from t;
----
pe
ma
di

statement ok
CALL get_substrait('select substring(a FROM 1 FOR 2) from t');

statement ok
CALL get_substrait('select substring(a FROM 1 FOR 2) in (''pe'', ''ma'') from t');